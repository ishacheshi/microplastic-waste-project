---
title: "Do countries that have higher plastic waste have higher ingestion of microplastics?"
author: "Indri Adisoemarta, Ishani P. Cheshire, Nadaa Moharram"
date: "2024-12-13"
output: 
  pdf_document:
    toc: no
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

\newpage

## Abstract
Microplastic ingestion is a major health concern, as microplastics can mimic human hormones, increasing risk of fetal developmental issues and cancer (Gonzalez, 2024). We hypothesize countries with higher proportions of plastic waste to have higher rates of ingestion of microplastics. We approximate human ingestion of microplastics through seafood in coastal countries with the average microplastic concentrations found in their adjacent oceans. We create two linear models—one directly relating microplastic concentrations to plastic waste emitted, and one which additionally considers country GDP—neither of which ultimately achieve statistical significance. In the future, we hope to add average ocean current velocity to our model, as we believe this would explain a great amount of the variation in microplastic concentration.

\newpage

## Introduction

Microplastics are plastic particles that are less than 5mm in length, and have been identified in our atmospheric, aquatic, and terrestrial environments, as well as in drinking water and food products (Senathirajah, 2021). Chemicals in microplastics can mimic human hormones such as BPA and PFAS (Gonzalez, 2024), and exposure to these substances has been shown to increase the risk of conditions ranging from infertility to poorer fetal development and cancer. Seafood is one possible vector of exposure to microplastics, and it’s been estimated that up to 50,000 microplastic particles are ingested annually by adults through seafood (Nicole, 2021). To address this issue, our research question is:

*Do countries that have higher plastic waste have higher ingestion of microplastics?*

We will approximate human ingestion of microplastics through seafood with the microplastic concentrations found in the oceans near the countries of interest. Then, we will build a linear model to determine whether there is a relationship between the plastic waste generated by a country and the associated microplastics found in nearby water sources. The results of our descriptive analysis will inform governments of the importance of reducing plastic waste to reduce microplastic consumption and improve public health.

## Data

To get data on microplastic concentrations per region, we pulled data from the National Centers for Environmental Information. The dataset includes the associated ocean, region, sampling method, measurement, measurement units, latitude, longitude, as well the research group that collected the data. To find associated plastic waste per country in tons, we pulled data from Our World in Data, which has plastic waste emitted per country to the ocean, for the year 2019. To find associated Gross Domestic Product per country in US dollars, we pulled data from World Bank Group reports for the year 2019.

The microplastic data only has latitude, longitude, and the associated ocean region (like the Indian Ocean.) In order to join the two datasets by country, we used the rnaturalearth library to identify the closest country by distance, and we validated the points visually and by mapping the points with R. One issue with this association is that this does not take into account ocean current movements, as plastic located close to a country does not necessarily mean it came from that country.

```{r data_cleaning, message=FALSE, echo=FALSE}
library(tidyverse)
library(ggplot2)
library(sandwich)
library(stargazer)
library(janitor)
library(dplyr)
library(car)
library(lmtest)
library(gridExtra)
library(moments)
library(psych)
library(patchwork)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)

# Read in microplastics data
data_2018_2021 <- read.delim("Marine_Microplastics_2018_2021.csv", sep=",", header=TRUE)

# read in total plastic waste emitted per country
country_plastics <- read.delim("plastic-waste-emitted-to-the-ocean.csv", sep=",", header=TRUE)

# read in gdp per country
gdp <- read.delim("gdp_2019.csv", sep=",", header=TRUE)

# Function to associate microplastic points with country
mp_countries <- function(input_data) {
  # Load world countries
  world <- ne_countries(scale = "medium", returnclass = "sf")
  
  # Transform coordinates
  mp_sf <- st_as_sf(input_data, coords=c("Longitude", "Latitude"), crs=4326)
  
  # Find the nearest country
  nearest_countries <- st_nearest_feature(mp_sf, world)
  
  # Add country names to input_data
  input_data$country <- world$admin[nearest_countries]
  
  # Calculate distances
  distances <- st_distance(mp_sf, world)
  min_distances <- apply(distances, 1, min)
  input_data$distance_to_country_km <- as.numeric(min_distances) / 1000
  
  return(input_data)
}

# Function to clean country plastics dataframe
clean_country_plastics <- function(input_plastics) {
  # Match country names between datasets
  input_plastics <- input_plastics %>%
    mutate(Entity = case_when(
      Entity == "United States" ~ "United States of America",  # Rename United States
      Entity == "Bahamas" ~ "The Bahamas",
      Entity == "Cape Verde" ~ "Cabo Verde",
      Entity == "Micronesia" ~ "Federated States of Micronesia",
      Entity == "Hong Kong" ~ "Hong Kong S.A.R.",
      Entity == "Macau" ~ "Macao S.A.R",
      TRUE ~ Entity                                            # Keep other values unchanged
    ))
  
  input_plastics$country <- input_plastics$Entity
  
  # Rename waste column
  input_plastics <- input_plastics %>% rename_at('Mismanaged.waste.emitted.to.the.ocean..metric.tons.year.1.', ~'WasteEmitted_MetricTonsYear')
  
  return(input_plastics)
}

# Function to clean GDP dataframe
clean_gdp <- function(input_gdp) {
  # Rename column using colnames()
  colnames(input_gdp)[colnames(input_gdp) == "Country.Name"] <- "country"
  colnames(input_gdp)[colnames(input_gdp) == "X2019..YR2019."] <- "GDP"
  
  input_gdp <- input_gdp%>%
    mutate(country = case_when(
      country== "United States" ~ "United States of America",  # Rename United States
      country == "Bahamas, The" ~ "The Bahamas", 
      country == "Russian Federation" ~ "Russia", 
      country == "Brunei Darussalam" ~ "Brunei",
      country == "Micronesia, Fed. Sts." ~ "Federated States of Micronesia",
      country == "Hong Kong SAR, China" ~ "Hong Kong S.A.R.",
      country == "Macao SAR, China" ~ "Macao S.A.R",
      country == "St. Vincent and the Grenadines" ~ "Saint Vincent and the Grenadines",
      TRUE ~ country                                        # Keep other values unchanged
    ))
  return(input_gdp)
}

# Function to create microplastic country weighting
create_weighting <- function(input_data) {
  # Small constant to avoid division by zero
  epsilon <- 0.01
  input_data$GDP <- as.numeric(input_data$GDP)
  
  # Calculate weights and weighted measurement
  weighted_df <- input_data %>%
    mutate(
      weight = 1 / (distance_to_country_km + epsilon),       # Calculate weights
      weighted_measurement = Measurement * weight           # Weighted measurement
    ) %>%
    group_by(country) %>%
    summarise(
      weighted_measurement = sum(weighted_measurement) / sum(weight), # Weighted average
      WasteEmitted_MetricTonsYear = mean(WasteEmitted_MetricTonsYear),# Use mean as WasteEmitted is constant per country
      GDP = mean(GDP)
    )
  
  return(weighted_df)
}

# Create cleaned microplastics, plastic waste, gdp data
data_2018_2021 <- mp_countries(data_2018_2021)
country_plastics <- clean_country_plastics(country_plastics)
gdp <- clean_gdp(gdp)

# Left join data with total plastic per country
joined_data_2018_2021 = merge(data_2018_2021, country_plastics, by='country', all.x=TRUE)

# Left join merged data with gdp
joined_data_2018_2021 = merge(joined_data_2018_2021, gdp, by='country', all.x=TRUE)

# Filter microplastic unit to pieces/m3
filt_mp_data_2018_2021 <- subset(joined_data_2018_2021, Unit=="pieces/m3")

# Weigh microplastics data by distance to country
weighted_mp_data_2018_2021 <- create_weighting(filt_mp_data_2018_2021)

# Keep the complete cases
weighted_2018_2021_complete <- weighted_mp_data_2018_2021[complete.cases(weighted_mp_data_2018_2021),]

# Remove Waste Emitted values with 0
weighted_2018_2021_complete <- subset(weighted_2018_2021_complete, WasteEmitted_MetricTonsYear != 0)

# Function to log the data
log_data <- function(input_data) {
  
  input_data$log_WasteEmitted_MetricTonsYear <- log10(input_data$WasteEmitted_MetricTonsYear)
  input_data$log_GDP <- log10(input_data$GDP)
  input_data$log_weighted_measurement <- log10(input_data$weighted_measurement)
  return(input_data)
}

logged_weighted_2018_2021_complete <- log_data(weighted_2018_2021_complete)
```

## Operationalization

While it may be that the plastic waste produced by a country does not, in fact, end up in the marine areas closest to that country, this in and of itself would be an interesting result, which would be reflected in our data. In the dataset, we will be using the variable “Microplastics Measurement (density)” as our outcome variable (Y). We are using this outcome variable instead of the actual ingestion rate of microplastics by fish as we don’t have any data on microplastic ingestion by fish, data on marine microplastic density is plentiful, and numerous studies have seen a statistically significant relationship between particle concentration and particles/fish (Roch et al., 2020.) Our descriptive variable (X) will be “Total Plastic Waste (MT)” produced by a country. Another descriptive variable we will consider is Gross Domestic Product and whether it’s related to microplastic measurement.

Out of 195 recognized countries our data contains 50 as we were focused on coastal countries as we could then identify ocean plastic to countries based on the distance of the plastic to the country. Given that our dataset is collection of reports from various universities around the world, this research spans the years 2018 to 2021 so it could have enough data from different areas of the world. Restricting the data to one year strongly limited our dataset. The GDP and emitted plastic data used was from the year 2019 as to avoid any covid impact. Furthermore, we removed data that reported 0 recorded waste emitted as after observing the distribution of our data we had to take the log of our outcome and descriptive variables. Lastly, to combine GDP and emitted waste for each country with the amount of microplastic in the ocean a weighted average was calculated as our microplastic data contained several data points from various universities for each country. To create a weighted measurement for each country based off of the proximity of the recorded observation we took the sum of the weight multiplied by the measurement divided by the sum of the weight, where weight was one over the distance.

## Model Assumptions

We start with the simplest possible model,  $\text{microplastic} = \beta_0 + \beta_1plastic\_waste$. Our small sample size ($n = 50$) means we must evaluate the CLM assumptions, starting with IID. This data will never be completely independent due to the nature of our topic—as countries that are closer to each other will have more similar ocean microplastic levels. There is also some bias in our selection of countries, as wealthier countries will be more likely to have the grants to fund environmentalist research like these microplastic surveys. Also, the data had to be taken over a span of three years in order to get enough data points for our analysis, creating some association for samples that were taken closer together temporally—however, we were careful not to expand the time range further than this, and we don’t expect microplastic levels to change substantially over such a short span of time.  Given the constraints, this data was collected as independently as possible with measurements coming from different research groups across the globe, so we accept the above risks as somewhat inevitable for this dataset.
Despite this, our raw data still does not fulfill the independence requirement due to the significant clustering at lower values, which becomes visible when we plot each countries’ average oceanic microplastics versus their emitted plastic waste (see Appendix, Figure A1, for supporting graphs.) To remedy this, we create Model 2 — a logged transformed version of model 1.

Model 2 improves on our first model by logging both our y and x variables: $log_{10}(microplastic) = \beta_0 + \beta_1log_{10}(plastic\_waste))$. To do this, we need to remove the few (6) data points with a zero value.

```{r fig2, fig.height=1.75, echo=FALSE}

model_2 = lm(log10(weighted_measurement) ~ log10(WasteEmitted_MetricTonsYear), data = logged_weighted_2018_2021_complete)

plot1 <- ggplot(logged_weighted_2018_2021_complete, aes(x = WasteEmitted_MetricTonsYear, y = weighted_measurement)) +
  geom_point() +
  labs(
    title = " Microplastic Density vs. Waste Emitted (Logged)",
    x = "Waste Emitted to Ocean (metric tons / yr) (Logged)",  # X-axis label
    y = "Microplastic Density (particles/m^3) (Logged)"   # Y-axis label
  ) +

  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  theme_minimal() +
  scale_y_log10() +
  scale_x_log10() +
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )
  
resids_2 <- residuals(model_2)
preds_2 <- predict(model_2)

model_2_results <- data.frame(
  residuals = resids_2,            # Add residuals
  predicted_values = preds_2  # Add predicted values
)

plot2 <- ggplot(model_2_results, aes(x = predicted_values, y = residuals)) +
  geom_point() +
  labs(
    title = "Model 2 Residuals vs. Predicted Microplastic Density",
    x = "Predicted Weighted Avg. Microplastic Density (particles/m^3)",  # X-axis label
    y = "Model 2 Residuals"   # Y-axis label
  ) +
  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

plot3 <- ggplot(logged_weighted_2018_2021_complete, aes(x = weighted_measurement)) +
  geom_histogram(color = "black", alpha = 0.7) +
  labs(
    title="Histogram of Logged Microplastic Density",       # Title
    x="Logged Microplastic Density Weighted Average (particles/m^3)",                              # X-axis label
    y="# of data points"                           # Y-axis label
  ) +
  scale_x_log10() +
  theme(plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

plot1 + plot2 + plot3

```

When assessing the first assumption of IID, we first note that the earlier clear clustering of data points disappears.  Even though countries themselves are associated with each other, considering the limitations of the data and the lack of clustering, we allow the assumption of independence to stand. 

The data must also be identically distributed. Our plastic waste emitted per country data is likely to be identically distributed, as data is being drawn from the larger overall distribution of countries across the globe. Microplastic concentration, however, had a huge amount of variation in sampling methods. Some sampling methods measured raw ‘counts’ of particles, while others measured ‘particles per time’, and still others measured ‘particles/volume’. These different sampling methods were, by their very nature, not identically distributed and could not be standardized and compared to each other. We didn’t have enough data points to limit our data to one sampling method, as would be ideal, so we instead limited our sample to only those sampling methods which measure the # of particles/volume. This number density can then be compared across sampling methods with reasonable confidence. Once filtered to only include number density measurements, the logged version of our microplastic concentrations seems to be identically distributed, as shown in the histogram. Therefore, we find identically distributed data to be a decent assumption. 

For our assumption of a linear conditional expectation, we note that the residuals of model 2 do not have a pattern. Instead, they seem random, giving us no evidence to reject this assumption. Regarding the third assumption of no perfect collinearity, we again note that model 2 also has only one x-variable, making this requirement redundant. We allow this assumption to pass automatically.

```{r bptest_model2, echo=FALSE}
bp_test <- bptest(model_2)
```

When looking at the model 2 residuals plot, the errors appear to be homoskedastic—that is, the magnitude of the residuals don’t change as we move to higher microplastic number density values. When we additionally conduct the Breushch-Pagan test ($H_0$: homoskedasticity, $H_a$: heteroskedasticity, alpha = 0.05), we find a p-value of `r format(round(bp_test$p.value, 3))`, indicating that we fail to reject the possibility of homoskedasticity. Therefore, with our ocular and statistical tests in agreement, we proceed confidently with the assumption of homoskedastic errors.

Finally, the errors from our model must be normally distributed. All of our points on the q-q plot (see Figure A2 in the Appendix) fall within the 95% confidence interval of normally distributed errors. Therefore, we proceed with this assumption. Overall, model 2 fulfills the required five CLM assumptions.

For Model 3, we decided to add GDP as a variable to account for the fact that plastic waste emitted is an easily manipulated variable by countries with more wealth, as they can send their plastic waste to poorer countries. For example, we saw that Norway had 0 tons of plastic waste emitted while the Philippines had the most plastic waste emitted. The model becomes $log_{10}(microplastic) = \beta_0 + \beta_1log_{10}(plastic\_waste) + \beta_2log_{10}(GDP)$.

To determine whether plastic waste is independent of GDP, it looks like there is some clustering as GDP is a skewed variable. When logging both plastic waste emitted and GDP, however, the spread is easier to see and no clear clusters are identified. There is nothing to indicate the data is not from identical distributions as there is only one GDP point per country.

```{r fig4, fig.height=1.75, echo=FALSE}

log_model_3 <- lm(log_weighted_measurement ~ log_WasteEmitted_MetricTonsYear + log_GDP, data=logged_weighted_2018_2021_complete)

plot1 <- ggplot(weighted_2018_2021_complete, aes(x = log10(WasteEmitted_MetricTonsYear), y = log10(GDP))) +
  geom_point() +
  labs(title = "Plastic Waste Emitted vs. GDP (logged)",
       x = "Plastic Waste Emitted to Ocean (metric tons / yr) (logged)",
       y = "GDP ($) (logged)") +
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

resids <- residuals(log_model_3)
preds <- predict(log_model_3)
model_3_results <- data.frame(
  residuals = resids,            # Add residuals
  predicted_values = preds  # Add predicted values
)

plot2 <- ggplot(model_3_results, aes(x = predicted_values, y = residuals)) +
  geom_point() +
  labs(
    title = "Model 3 Residuals vs. Predicted Weighted Avg. Microplastic Number Density",
    x = "Predicted Weighted Avg. Microplastic Number Density (particles/m^3)",  # X-axis label
    y = "Model 3 Residuals"   # Y-axis label
  ) +
  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

bp_test_model_3 <- bptest(logged_weighted_2018_2021_complete$log_weighted_measurement ~ logged_weighted_2018_2021_complete$log_GDP)

plot1 + plot2

```

We next evaluate whether the errors are homoskedastic. When looking at the model 3 residuals plot, the errors appear to be homoskedastic—that is, the magnitude of the residuals don’t change as we move to higher microplastic number density values. When we additionally conduct the Breushch-Pagan test ($H_0$: homoskedasticity, $H_a$: heteroskedasticity, alpha = 0.05), we find a p-value of `r format(round(bp_test_model_3$p.value, 3))`, indicating that we fail to reject the possibility of homoskedasticity. Therefore, with our ocular and statistical tests in agreement, we proceed confidently with the assumption of homoskedastic errors. 

```{r fig5, fig.height=3, echo=FALSE}
vif_mod3 <- vif(log_model_3)
```

It is hard to see collinearity with the unlogged data, but with the logged data the spread is easier to see. You can see a slight correlation between log(Plastic Waste Emitted) and log(GDP). Refer to the Appendix (Figure A3) for the correlation graph. The VIF values are close to 1 (`r format(round(vif_mod3["log_GDP"], 3))`), which indicates moderate (but not severe) correlation between predictor variables of log of plastic waste emitted and log GDP.

To evaluate linear conditional expectation, we examine the residuals. The model residuals compared with the log(GDP) variable and the log(Plastic Waste Emitted) appear to be almost linear, and there are no points where the residuals are significantly different from 0.

```{r fig6, fig.height=1.75, echo=FALSE}

model_residuals = resid(log_model_3)
mod_preds = predict(log_model_3)

plot_log_GDP_resid <- logged_weighted_2018_2021_complete %>% 
  ggplot(aes(x = log_GDP, y = model_residuals)) +
  geom_point() + stat_smooth() +
  labs(
    title = "Model 3 Residuals vs. Logged GDP",
    x = "GDP ($) (Logged)",  # X-axis label
    y = "Model 3 Residuals"   # Y-axis label
  ) +
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

plot_log_plastic_waste_resid <- logged_weighted_2018_2021_complete %>% 
  ggplot(aes(x = log_WasteEmitted_MetricTonsYear, y = model_residuals)) +
  geom_point() + stat_smooth() +
  labs(
    title = "Model 3 Residuals vs. Logged Waste Emitted",
    x = "Plastic Waste Emitted to Ocean (metric tons / yr) (logged)",  # X-axis label
    y = "Model 3 Residuals"   # Y-axis label
  ) +
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

plot_log_GDP_resid + plot_log_plastic_waste_resid

```
Finally we need to determine whether the errors from our model are normally distributed. All points on the q-q plot (see Figure A4 in the Appendix) fall within the 95% confidence interval of normally distributed errors. Therefore, we proceed with this assumption. Overall, model 3 fulfills the required five CLM assumptions.

## Model Results and Interpretation

```{r fig8, fig.height=2, echo=FALSE}

plot1 <- ggplot(logged_weighted_2018_2021_complete, aes(x = WasteEmitted_MetricTonsYear, y = weighted_measurement)) +
  geom_point() +
  labs(
    title = "Model 2: Microplastic Density vs. Waste Emitted",
    x = "Waste Emitted to Ocean (metric tons / yr) (logged)",  # X-axis label
    y = "Weighted Avg. Microplastic Density (particles/m^3) (logged)"   # Y-axis label
  ) +

  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  scale_y_log10() +
  scale_x_log10() +
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

mod2 = lm(log10(weighted_measurement) ~ log10(WasteEmitted_MetricTonsYear), data=logged_weighted_2018_2021_complete)

plot2 <- ggplot(logged_weighted_2018_2021_complete, aes(x = log10(WasteEmitted_MetricTonsYear) + log10(GDP), y = weighted_measurement)) +
  geom_point() +
  labs(
    title = "Model 3: Microplastic Density vs. Waste Emitted and GDP",
    x = "Waste Emitted to Ocean (metric tons / yr) (logged) and GDP (logged)",  # X-axis label
    y = "Weighted Avg. Microplastic Density (particles/m^3) (logged)"   # Y-axis label
  ) +

  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  scale_y_log10() +
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

model3 = lm(log10(weighted_measurement) ~ log10(WasteEmitted_MetricTonsYear) + log10(GDP), data=logged_weighted_2018_2021_complete)

plot1 + plot2

```

For model 2,  $log_{10}(microplastic) = \beta_0 + \beta_1log_{10}(plastic\_waste)$, the interpretation of our slope would have been that the microplastic number density off the coast of a country is exponentially related to that country’s plastic waste emitted, with the power of the exponent being the our slope. However, the p-value for the slope is `r format(round(summary(mod2)$coefficients[2,4], 3))` which is slightly above the threshold value. This suggests weak evidence that the waste emitted by a country impacts the amount of microplastics found in their nearby ocean, so our model 2 slope has no practical interpretation.
The model 2 R squared value is only `r format(round(summary(mod2)$r.squared, 3))` indicating that there are more variables we should be looking at to explain microplastic correlation.

For model 3,  $log_{10}(microplastic) = \beta_0 + \beta_1log_{10}(plastic\_waste) + \beta_2log_{10}(GDP)$, the p-value for the slope is `r format(round(summary(model3)$coefficients[2,4], 3))` for GDP which indicates that this relationship is not statistically significant. The same follows for emitted waste with a p-value of `r format(round(summary(model3)$coefficients[3,4], 3))`. This suggests weak evidence that the waste emitted by country and GDP impacts the amount of microplastics found in the ocean, so our model 3 has no practical interpretation.
The model 3 R squared value is only `r format(round(summary(model3)$r.squared, 3))` indicating that there are more predictors to assess to explain microplastic correlation.

```{r star, results='asis', echo=FALSE}
stargazer(mod2,
          model3,
          header = FALSE,
          title="Regression Results for Model 2 and Model 3",
          covariate.labels=c("Plastic Waste Emitted (metric tons/yr) (logged)", "GDP in dollars (logged)"),
          dep.var.labels = c("Microplastic particles/meter cubed"),
          object.names = TRUE,
          column.labels = c("Model 2", "Model 3"),
          font.size = "tiny",
          type="latex")
```

Although our model 2 came close to the required threshold, ultimately none of our models were  statistically significant, indicating that there are more variables we needed to look at to explain microplastic concentration. In the future, we hope to look into adding average ocean current speed to our model, as we believe that this would have a major impact on the distribution of microplastic particles.

\clearpage
\newpage

# Appendix

## Links to Data Sources
https://experience.arcgis.com/experience/b296879cc1984fda833a8acc93e31476

https://ourworldindata.org/plastic-pollution?insight=most-ocean-plastics-today-come-from-middle-income-countries#key-insights

https://data.imf.org/regular.aspx?key=63122827

## List of Model Specifications

All of the models we tried are mentioned in the paper.

## Residuals vs. Fitted Values Plot

See our Model Assumptions.

## Additional Figures

\textbf{Figure A1}

*Supporting graphs for Model 1*

```{r fig1, fig.height=2, echo=FALSE}

model_1 = lm(weighted_measurement ~ WasteEmitted_MetricTonsYear, data = logged_weighted_2018_2021_complete)

plot1 <- ggplot(logged_weighted_2018_2021_complete, aes(x = WasteEmitted_MetricTonsYear, y = weighted_measurement)) +
  geom_point() +
  labs(
    title = "Microplastic Number Density vs. Waste Emitted (with Model)",
    x = "Waste Emitted to Ocean (metric tons / yr)",  # X-axis label
    y = "Weighted Avg. Microplastic Density (particles/m^3)"   # Y-axis label
  ) +

  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

resids <- residuals(model_1)
preds <- predict(model_1)

model_1_results <- data.frame(
  residuals = resids,            # Add residuals
  predicted_values = preds  # Add predicted values
)

plot2 <- ggplot(model_1_results, aes(x = predicted_values, y = residuals)) +
  geom_point() +
  labs(
    title = "Model 1 Residuals vs. Predicted Microplastic Density",
    x = "Predicted Weighted Avg. Microplastic Density (particles/m^3)",  # X-axis label
    y = "Model 1 Residuals"   # Y-axis label
  ) +
  geom_smooth(method = "lm", formula = y ~ x, color = "blue", se = FALSE) +  # Linear regression line
  theme(
    plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

plot3 <- ggplot(logged_weighted_2018_2021_complete, aes(x = weighted_measurement)) +
  geom_histogram(color = "black", alpha = 0.7) +
  labs(
    title="Histogram of Microplastic Density",       # Title
    x="Microplastic Number Density Weighted Average (particles/m^3)",                              # X-axis label
    y="# of data points"                           # Y-axis label
  ) +
  theme(plot.title = element_text(size = 6),  # Adjust title text size
    axis.title.x = element_text(size = 5), # Adjust x-axis label size
    axis.title.y = element_text(size = 5),  # Adjust y-axis label size
    axis.text.x = element_text(size = 5),     # X-axis tick label size
    axis.text.y = element_text(size = 5)      # Y-axis tick label size
  )

plot1 + plot2 + plot3

```

\textbf{Figure A2}

*Q-Q Plot for Model 2*

```{r fig3, fig.width=7, fig.height=2, echo=FALSE}

x <- resids_2

q <- ppoints(x)

d <- tibble(
  x_sample = x,
  quantile = ppoints(length(x_sample)),
  x_theoretical = qnorm(q, mean(x_sample), sd(x_sample))
)

d$z_theoretical <- qnorm(d$quantile, 0, 1)

# Given z scores and n, produce a standard error
se_z <- function(z, n) {
  sqrt(pnorm(z) * (1 - pnorm(z)) / n) / dnorm(z)
}

band <- tibble(
  z = seq(-2.2, 2.2, length.out = 300),
  n = length(d$x_sample),

  sample_sd = sd(d$x_sample),
  se = sample_sd * se_z(z, n),
  line = mean(d$x_sample) + sample_sd * z,
  upper = line + 2 * se,
  lower = line - 2 * se,

  robust_sd = IQR(d$x_sample) / 1.349,
  robust_line = median(d$x_sample) + z * robust_sd,
  robust_se =  robust_sd * se_z(z, n),
  robust_upper = robust_line + 2 * robust_se,
  robust_lower = robust_line - 2 * robust_se,
)

# Set margins on Q-Q plots
par(mar = c(4, 2, 1, 2))

# Use patchwork to capture the plots and combine them
# into a side by side display.
library(patchwork)

par(cex.axis = 0.5, cex.lab = 0.6, cex.main = 0.7)
par(mgp = c(2, 1, 0))
par(mar = c(4, 4, 1, 2))
car::qqPlot(x, xlab = "Theoretical Quantiles", ylab = "Sample Quantiles",main = "Model 2 Q-Q Plot with 95% Confidence Interval",id = FALSE)

```

\textbf{Figure A3}

*Pairs Plot for Model 3*

```{r fig10, fig.height=3, echo=FALSE}
# get subset of data for plot
subset <- select(logged_weighted_2018_2021_complete, log_WasteEmitted_MetricTonsYear, log_GDP, log_weighted_measurement)

pairs(subset[,-1])
```

\textbf{Figure A4}

*Q-Q Plot for Model 3*

```{r fig7, fig.height=2, echo=FALSE}

x <- model_residuals

q <- ppoints(x)

d <- tibble(
  x_sample = x,
  quantile = ppoints(length(x_sample)),
  x_theoretical = qnorm(q, mean(x_sample), sd(x_sample))
)

d$z_theoretical <- qnorm(d$quantile, 0, 1)

# Given z scores and n, produce a standard error
se_z <- function(z, n) {
  sqrt(pnorm(z) * (1 - pnorm(z)) / n) / dnorm(z)
}

band <- tibble(
  z = seq(-2.2, 2.2, length.out = 300),
  n = length(d$x_sample),

  sample_sd = sd(d$x_sample),
  se = sample_sd * se_z(z, n),
  line = mean(d$x_sample) + sample_sd * z,
  upper = line + 2 * se,
  lower = line - 2 * se,

  robust_sd = IQR(d$x_sample) / 1.349,
  robust_line = median(d$x_sample) + z * robust_sd,
  robust_se =  robust_sd * se_z(z, n),
  robust_upper = robust_line + 2 * robust_se,
  robust_lower = robust_line - 2 * robust_se,
)

# Set margins on Q-Q plots
par(mar = c(4, 2, 1, 2))

# Use patchwork to capture the plots and combine them
# into a side by side display.
library(patchwork)

par(cex.axis = 0.5, cex.lab = 0.6, cex.main = 0.7)
car::qqPlot(x, xlab = "Theoretical Quantiles", ylab = "Sample Quantiles",main = "Model 3 Q-Q Plot with 95% Confidence Interval",id = FALSE)

```

## References

Senathirajah, 2021. Journal of Hazardous Materials, Volume 404, Part B, 2021, 124004, ISSN 0304-3894, https://doi.org/10.1016/j.jhazmat.2020.124004.

González, 2024. UCSF https://www.ucsf.edu/news/2024/02/427161/how-to-limit-microplastics-dangers 

Nicole, W. 2021, Environmental Health Perspectives, 129, 3034001, doi: 10.1289/EHP89364. https://ehp.niehs.nih.gov/doi/10.1289/EHP8936 




